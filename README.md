## Πως να εκτελέσεις το webservice
Στο terminal εκτελούμε τις εντολές :
* `(sudo) docker run -d -p 27017:27017 --name mongodb mongo`
* `cd ./app/flask`
* `python3 app.py`

Containerization:
1. `cd /app/flask`
2. `(sudo) docker build --tag a_name .`
3. `cd ..`
4. `(sudo) docker-compose up`

## Λειτουργίες του συσήματος

Να σημειωθεί ότι χρησιμοποιείται η εφαρμογή __Postman__ για την εισαγωγή δεδομένων στο Body. Ωστόσο μπορεί να χρησιμοποιηθεί και η εντολή `curl`.

### Για τον **Απλό Χρήστη** 

* #### 1ο ENDPOINT: Εισαγωγή χρηστών στο σύστημα
Ο απλός χρήστης εισάγει το email του, το name και το password. Αν το email είναι μοναδικό `users.find({"email":data['email']}).count() == 0:` τότε εισάγεται στο σύστημα (collection **Users**) και το προστίθεται και η κατηγορία **Simple Costumer**. Επιστρέφεται επίσης μήνυμα επιβεβάιωσης. Αν το email δεν είναι μοναδικό τότε επιστρέφεται ανάλογο μήνυμα.

* #### 2o ENDPOINT: Login στο σύστημα
Ο χρήστης εισάγει το email και το password του. Αν είναι σωστά τότε του επιστρέφεται το email και ένας μοναδικός κωδικός ( **uuid**). Αν τα στοιχεία δεν είναι σωστά, επιστρέφεται ανάλογο μήνυμα.

* #### 3o ENDPOINT: Επιστροφή προϊόντος με βάσει όνομα, κατηγορία, ID
Ο χρήστης μπορεί αν είσαγει είτε το όνομα **(name)** του προϊόντος που θέλει να αναζητήση, είτε την κατηγορία **(category)** στην οποία ανήκει είτε το αναγνωριστικό του (**__id)**. Επίσης πρέπει να εισάγει στα headers το **uuid**.
 1. Αν επιλέξει **name**:
    * Του επιστρέφεται μια λίστα με όλα τα προϊόντα που φέρουν το ίδιο όνομα και τα στοιχεία τους, ταξινομημένη βάση ονόματος (`sortedproductList = sorted(productsList, key = lambda x: x['name']`) . Σε περίπτωση που δεν βρεθούν προϊόντα επιστρέφει ανάλογο μήνυμα.
 2. Aν επιλέξει **category**:
    * Του επιστρέφεται μια λίστα με όλα τα προϊόντα που ανήκουν στην κατηγορία που έχει εισάγει και τα στοιχεία τους, ταξινομημένη βάση τιμής προϊόντος (`sortedcategoryList = sorted(categoryList, key = lambda x: x['price']`) . Σε περίπτωση που δεν βρεθούν προϊόντα επιστρέφει ανάλογο μήνυμα.
 3. Αν επιλέξει **__id**
    * Του επιστρέφεται μια λίστα με τα στοιχεία του προϊόντος με το συγκεκριμένο **__id** .
 Σε περίπτωση που δεν βρεθούν προϊόντα επιστρέφει ανάλογο μήνυμα. Σε περίπτωση που δεν βρεθούν προϊόντα επιστρέφει ανάλογο μήνυμα.
 
 * #### 4ο ΕΝDPOINT: Προσθήκη προϊόντων στο καλάθι
 Ο χρήστης πρέπει να εισάγει το id του προϊόντος αλλά και τον αριθμό τεμαχίων **(quantity)** που θέλει να αγοράσει. Επίσης πρέπει να εισάγει στα headers το **uuid**.
 Αν η ποσότητα που θέλει ο χρήστης δεν υπερβαίνει την πόσοτητα του αποθέματος, τότε το πεδίο **stock** του προϊόντος αντικαταστείται με ένα νεό πεδίο το **quantity** και τότε το προϊόν εισάγεται στο καλάθι του πελάτη(**basket**). Στην συνέχεια υπολογίζεται το συνολικό ποσό (`total = sum(d["price"] * d["quantity"] for d in basket`). Τέλος εμφανίζεται το
καλάθι με όλα τα προϊόντα που έχουν προστεθεί και το συνολικό κόστος των προϊόντων που είναι στο καλάθι μέχρι εκείνη τη στιγμή. Σε περίπτωση που η ποσότητα που θέλει ο χρήστης υπερβαίνει την πόσοτητα του αποθέματος ή δεν υπάρχει καθόλου απόθεμα εμφανίζεται συγκεκριμένο μήνυμα.

* #### 5o ENDPOINT: Εμφάνιση καλαθιού
 Επιστρέφεται το καλάθι με όλα τα προϊόντα που έχουν προστεθεί αλλά και το συνολίκο κόστος.
 
* #### 6o ENDPOINT: Διαγραφή προϊόντος από το καλάθι.
Ο χρήστης εισάγει το (**__id**) του προϊόντος. Επίσης πρέπει να εισάγει στα headers το **uuid**.Εντοπίζεται το προϊόν με το συγκεκριμένο id και στην συνέχει αφαιρείται από το καλάθι (`basket.remove(d)`). Στη συνέχεια εμφανίζεται το ανανεωμένο καλάθι με όλα τα προϊόντα πουυπάρχουν ακόμα σε αυτό, καθώς και το κόστος όπως έχει διαμορφωθεί. 

* #### 7o ENDPOINT: Αγορά προϊόντων
Ο χρήστης εισάγει τον 16ψήφιο αριθμός της κάρτα του (**debit_card_number**) και το αναγνωριστικό του (**__id**). Αν ο κωδικός της κάρτας του είναι 16 ψηφίων τότε εισάγεται στο ιστορικό παραγγελίων του (`users.update({"_id": ObjectId(data['_id'])}, {"$set":{"orderHistory": basket}}) `) τα προϊόντα που έχει στο καλάθι και εκτυπώνεται η απόδειξη με το συνολικό ποσό. Αν ο κωδικός της κάρτας είναι λανθασμένος εμφανίζεται ανάλογο μήνυμα.

* #### 8o ENDPOINT: Εμφάνιση ιστορικού παραγγελιών του συγκεκριμένου χρήστη
O χρήστης εισάγει το id του αλλά και το **uuid** στα header.Στην συνέχεια εμφανίζεται το ιστορικό παραγγελιών (**orderHistory**) του .

* #### 9o ENDPOINT: Διαγραφή του λογαριασμού
Ο χρήστης εισάγει το id του αλλά και το το **uuid** στα header. Εντοπίζεται ο χρήστης με το συγκεκριμένο αναγνωριστικό και στην συνέχεια διαγράφεται από το σύστημα ( `users.delete_one({"_id": ObjectId(user['_id'])}) ` ). Επιστρέφεται επίσης ανάλογο μήνυμα.

### Για τον **Διαχειριστή**
* #### 1o ENDPOINT: Εισαγωγή νέου προϊόντος
Ο διαχειριστής εισάγει το όνομα του προϊόντος(**name**), την κατηγορία στην οποία ανήκει(**category**), το πλήθος που υπάρχει διαθέσιμο στο κατάστημα προς
πώληση (**stock**), την περιγραφή(**description**) του προϊόντος και την τιμή(**price**) του. Στην συνέχεια το προϊόν εισάγεται στο σύστημα.

* #### 2o ENDPOINT: Διαγραφή προϊόντος από το σύστημα
Ο διαχειριστής εισάγει το id του προϊόντος στο σύστημα. Εντοπίζεται το προϊόν με το συγκεκριμένο id και έπειτα διαγράφεται.

* #### 3o ENDPOINT: Ενημέρωση κάποιου προϊόντος
Ο διαχειριστής εισάγει το id του προϊόντος στο σύστημα. Επίσης εισάγει ένα ή περισσότερα απο τα πεδία πρός ενημέρωση:
* το όνομα(**name**) του προϊόντος
* την τιμή(**price**) του προϊόντος
* την περιγραφή(**description**) του προϊόντος
* το απόθεμα(**stock**)
Αφού ο διαχειριστής εισάγει ένα ή περισσότερα από τα προαναφερόμενα πεδία και τις τιμές τους, ενημερώνονται στο σύστημα.
